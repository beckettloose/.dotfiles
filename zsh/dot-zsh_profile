export XDG_CONFIG_HOME=$HOME/.config

### Set up important env vars ###

VIM="nvim"
export EDITOR=$VIM
export GIT_EDITOR=$VIM
export KUBE_EDITOR=$VIM

path=("$HOME/.local/scripts/bin" $path)
path=("$HOME/.local/bin" $path)
export PATH

### Set up personal aliases and functions ###

# Map vim and vi as shortcuts to nvim
alias vim="nvim"
alias vi="nvim"

# Reloads the shell instance
# Note that using this repeatedly in the same shell will progressively make
# environment variables like PATH get longer as each successive reload appends
# more entries. Avoid using this repeatedly
alias reload="exec zsh"

# wget but let the server tell us what the file name should be
alias dl="wget --content-disposition"

# tmux shortcuts
alias tls="tmux list-sessions"
alias ta="tmux attach"
alias tcl="tmux clock-mode"

# Print return code of last executed command
rtc() {
    echo "$?"
}

# mkdir and cd into it
mkcd() {
    \mkdir -p "$1"
        cd "$1"
}

# make temp directory and cd into it
tempe () {
    cd "$(mktemp -d)"
    chmod -R 0700 .
    if [[ $# -eq 1 ]]; then
        \mkdir -p "$1"
        cd "$1"
        chmod -R 0700 .
    fi
}

# play sound effect based on return code of last command
boop () {
    local last="$?"
    if [[ "$last" == '0' ]]; then
        sfx good
    else
        sfx bad
    fi
    $(exit "$last")
}

# profile zsh startup time without modifying config file
zshprof() {
    ZPROF=1 zsh -i -c exit | less
}

### Set up zsh key bindings ###

export KEYTIMEOUT=1
bindkey '^[' .vi-cmd-mode

# Tmux sessionizer as zle widget
tmux_sessionizer_setup="$HOME/.local/scripts/resources/tmux-sessionizer-setup.zsh"
if [[ -f "$tmux_sessionizer_setup" ]]; then
    source "$tmux_sessionizer_setup"
    bindkey "^f" _tmux-sessionizer
fi

# Quick ssh shortcut
fzf_ssh_setup="$HOME/.local/scripts/resources/fzf-ssh-setup.zsh"
if [[ -f "$fzf_ssh_setup" ]]; then
    source "$fzf_ssh_setup"
    bindkey ^s _fzf-ssh
fi

# Quick git switch shortcut
fzf_git_switch_setup="$HOME/.local/scripts/resources/fzf-git-switch-setup.zsh"
if [[ -f "$fzf_git_switch_setup" ]]; then
    source "$fzf_git_switch_setup"
    bindkey "^[s" _fzf-git-switch
    bindkey "^[S" _fzf-git-switch-all
fi

# unbind fwd-i-search
# bindkey -r ^s

# search aliases using grep
alias agrep="alias | grep"

